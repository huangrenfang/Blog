# http 演进

## http/0.9

### 背景

用于学术交流，起初的需求很简单，只需要传输 html 文件就行了,因此他也仅支持 get 方法和

### httt/0.9 特点

1. 只有请求行，没有请求头和请求体，无法处理其他类型的资源。
2. 响应数据也没有响应头，只返回数据
3. 返回的 html 文件都是都是 ASCII 码字符流传输的,因为都是 html 格式的文件
4. 不支持持久连接
5. 不支持 https

## http/1.0

### 背景

随着网络的发展，人们对网络的诉求越来越多，http 不仅需要传输 html 了。  
他还需要支持更多的内容，CSS，图片、视频、音频等

### http/1 特点

1. 引入请求头和响应头, 通过 Accept-x 等字段实现期望返回的资源类型、压缩方式、编码类型、语言等
2. 引入了更多的状态码，来告知浏览器资源响应情况以及请求的各种状态
3. 引入缓存机制，减轻服务器压力和提高重复资源的打开速度

### http/1 缺点

1. 性能问题：HTTP/1.0 每次请求都需要建立新的 TCP 连接，这会导致网络延迟和资源浪费。
2. 传输效率低：HTTP/1.0 传输数据时，每个请求和响应都必须包含完整的 HTTP 头部信息，这会导致传输效率低下。
3. 无法处理动态内容：HTTP/1.0 只能处理静态资源，无法处理动态内容，如交互式 Web 应用程序。
4. 安全性问题：HTTP/1.0 不支持加密，数据传输时存在安全隐患。

## http/1.1

### 背景

因为 http/1 的性能和安全问题比较明显，http/1.1 是基于 http/1 的基础之上进行了改良（缝补）

### http/1.1 特点

1. 持久化连接改善 http/1 每次请求都需要建立连接的问题，只有浏览器和服务器没有明确断开连接就会一直保持(默认开启且一个域名最多六个持久化连接)
2. 提供虚拟主机支持
3. 引入 cookie 机制
4. 缓存控制 cache-control, ETag
5. 分块传输，服务器响应可以分批来传输，浏览器能先接收一步提前处理

### http/1.1 缺点

1. http 队头阻塞，因为一个连接通道是串行的，只能等请求返回才能发送另外一个请求
2. 无法处理大量并发请求，一个域名最多六个连接通道

## http/2

### 背景

因为 http/1.1 存在 TCP 连接慢启动、http 队头阻塞以及六条连接竞争固定带宽等问题导致传输效率低下

### http/2 特点

**多路复用**

1. 一个域名只使用一个 TCP 长连接，慢也只慢这一次，避免了慢启动、多条连接竞争固定带宽的问题
2. 请求并行发送，解决了队头阻塞的问题
3. 因为多路复用的二进制分帧特性，可以设置请求的优先级
4. 头部压缩，将请求头和响应头进行压缩
5. 支持 TSL 协议加密

### http/2 缺点

1. 对服务器有要求，如果需要 TSL 加密，服务器需要支持 TSL1.2 及以上版本
2. http/2 不是所有浏览器和服务都兼容
3. 二进制分帧、并发请求会导致服务器存在压力负担
4. 基于 TCP 连接，存在 TCP 队头阻塞

### 多路复用二进制分帧传输过程

1. 首先，浏览器准备好请求数据，包括了请求行、请求头等信息，如果是 POST 方法，那么还要有请求体。
2. 这些数据经过二进制分帧层处理之后，会被转换为一个个带有请求 ID 编号的帧，通过协议栈将这些帧发送给服务器。
3. 服务器接收到所有帧之后，会将所有相同 ID 的帧合并为一条完整的请求信息
4. 然后服务器处理该条请求，并将处理的响应行、响应头和响应体分别发送至二进制分帧层。
5. 同样，二进制分帧层会将这些响应数据转换为一个个带有请求 ID 编号的帧，经过协议栈发送给浏览器。
6. 浏览器接收到响应帧之后，会根据 ID 编号将帧的数据提交给对应的请求。

## http/3

### 背景

更快的网络传输

### http/3 特点

1. 基于 UDP 协议实现的可靠传输 QUICk，更快的速度，避免了 TCP 协议因为一个数据包丢失而产生了整个连接暂停

### http/3 缺点

1. 和 http2 一样存在不兼容问题
2. 中间设备僵化（同样的不兼容问题）
